// PO Table checkbox
arrayRet = ["PO26-00976","PO26-00977"]
transformedArrayRet = utils.array_to_array_string(arrayRet) 
TracePrint(transformedArrayRet)
hWeb = WebBrowser.BindBrowser("edge",10000,{"bContinueOnError":false,"iDelayAfter":300,"iDelayBefore":200})
sRet = WebBrowser.RunJS(hWeb,"function(){const input_values="& transformedArrayRet &';[...document.querySelectorAll('&"'div._xyda97.fixedDataTableLayout_main.public_fixedDataTable_main input[aria-label="&'"Purchase order"]'&"')].filter(i=>input_values.includes(i.value.trim())).forEach(i=>{const r=i.closest('[role="&'"row"]'&"')||i.closest('div');const c=r&&(r.querySelector('div[role="&'"checkbox"][aria-label="Include"]'&"')||r.querySelector('input[type="&'"checkbox"]'&"'));if(c){if(c.getAttribute){c.getAttribute('aria-checked')!=="&'"true"&&c.click()}else{!c.checked&&c.click()}}});'&" return 123}",true,{"bContinueOnError":false,"iDelayAfter":300,"iDelayBefore":200})

// Edit table logic
sRet = WebBrowser.RunJS(hWeb,"function() {try {const poUpdates = "&transformedArrayRet&"; const PO_INDEX = "&PO_INDEX&"; const DATE_INDEX = "&DATE_INDEX&"; const INVOICE_NUMBER_INDEX = "&INVOICE_NUMBER_INDEX&"; const updated_pos = []; const poMap = {}; poUpdates.forEach(row => { try { const po = row[PO_INDEX]; const date = row[DATE_INDEX]; const invoice = row[INVOICE_NUMBER_INDEX]; if (po) { poMap[po] = { date: date, invoice: invoice }; } } catch (mapError) { console.error("&'"'&"Error building poMap:"&'"'&", mapError); } }); const poInputs = document.querySelectorAll( "&'"'&"input[id^='PurchParmTable_PurchId'][id$='_input']"&'"'&" ); poInputs.forEach(poInput => { try { const poValue = poInput.value.trim(); if (poMap[poValue]) { const row = poInput.closest("&'"'&"[role='row']"&'"'&") || poInput.closest("&'"'&"tr"&'"'&") || poInput.parentElement?.parentElement?.parentElement; if (!row) return; const nativeSetter = Object.getOwnPropertyDescriptor( HTMLInputElement.prototype, "&'"'&"value"&'"'&" ).set; const dateInput = row.querySelector( "&'"'&"input[id^='PurchParmTable_TransDate_W'][id$='_input']"&'"'&" ); if (dateInput && poMap[poValue].date) { dateInput.focus(); dateInput.click(); nativeSetter.call(dateInput, poMap[poValue].date); dateInput.dispatchEvent(new Event("&'"'&"input"&'"'&", { bubbles: true })); dateInput.dispatchEvent(new Event("&'"'&"change"&'"'&", { bubbles: true })); } const invoiceInput = row.querySelector( "&'"'&"input[id^='PurchParmTable_gridParmTableNum'][id$='_input']"&'"'&" ); if (invoiceInput && poMap[poValue].invoice) { invoiceInput.focus(); invoiceInput.click(); nativeSetter.call(invoiceInput, poMap[poValue].invoice); invoiceInput.dispatchEvent(new Event("&'"'&"input"&'"'&", { bubbles: true })); invoiceInput.dispatchEvent(new Event("&'"'&"change"&'"'&", { bubbles: true })); } updated_pos.push({ po: poValue, date: poMap[poValue].date, invoice: poMap[poValue].invoice, status: "&'"'&"updated"&'"'&" }); console.log(`Updated PO ${poValue} ? Date: ${poMap[poValue].date}, Invoice: ${poMap[poValue].invoice}`); } } catch (innerError) { console.error("&'"'&"Error processing PO:"&'"'&", innerError); updated_pos.push({ po: poInput?.value || null, status: "&'"'&"error"&'"'&", error: innerError.message }); } }); return updated_pos; } catch (error) { console.error("&'"'&"Fatal error:"&'"'&", error); return [{ status: "&'"'&"fatal_error"&'"'&", error: error.message }]; }}",true,{"bContinueOnError":false,"iDelayAfter":300,"iDelayBefore":200})
            